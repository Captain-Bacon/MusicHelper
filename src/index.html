<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Keys Reference</title>

    <!-- PWA Configuration -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#34495e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Music Scales">
</head>
<body>
    <div class="container">
        <h1>MUSIC SCALES REFERENCE</h1>
        <div class="subtitle">COMPARE SCALES ACROSS KEYS</div>

        <div class="style-controls">
            <h3>üé® Layout Controls</h3>
            <div class="slider-group">
                <div class="slider-control">
                    <label>
                        Cell Padding (Horizontal)
                        <span class="slider-value" id="cellPaddingHValue">5px</span>
                    </label>
                    <input type="range" id="cellPaddingH" min="5" max="40" value="5" step="1">
                </div>

                <div class="slider-control">
                    <label>
                        Cell Padding (Vertical)
                        <span class="slider-value" id="cellPaddingVValue">9px</span>
                    </label>
                    <input type="range" id="cellPaddingV" min="5" max="40" value="9" step="1">
                </div>

                <div class="slider-control">
                    <label>
                        Header Font Size
                        <span class="slider-value" id="headerFontValue">16px</span>
                    </label>
                    <input type="range" id="headerFont" min="12" max="24" value="16" step="1">
                </div>

                <div class="slider-control">
                    <label>
                        Note Cell Font Size
                        <span class="slider-value" id="noteFontValue">19px</span>
                    </label>
                    <input type="range" id="noteFont" min="12" max="28" value="19" step="1">
                </div>

                <div class="slider-control">
                    <label>
                        Row Label Font Size
                        <span class="slider-value" id="rowLabelFontValue">19px</span>
                    </label>
                    <input type="range" id="rowLabelFont" min="14" max="32" value="19" step="1">
                </div>

                <div class="slider-control">
                    <label>
                        First Column Padding Left
                        <span class="slider-value" id="firstColPaddingValue">20px</span>
                    </label>
                    <input type="range" id="firstColPadding" min="10" max="50" value="20" step="1">
                </div>

                <div class="slider-control">
                    <label>
                        Table Max Width
                        <span class="slider-value" id="containerWidthValue">650px</span>
                    </label>
                    <input type="range" id="containerWidth" min="400" max="1400" value="650" step="50">
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="scales">Scales</button>
            <button class="tab-button" data-tab="progressions">Progressions</button>
            <button class="tab-button" data-tab="genre">Genre</button>
            <button class="tab-button" data-tab="theory">Chords & Theory</button>
        </div>

        <!-- Tab Content Panels -->
        <div class="tab-content-container">
            <!-- Scales Tab -->
            <div class="tab-panel active" id="scales-tab">
                        <!-- Scale Controls Section -->
                        <div class="controls">
                            <div class="scale-type-filters">
                                <strong>Scale Types:</strong>
                                <label>
                                    <input type="checkbox" id="filterMajor" value="major" checked>
                                    Major
                                </label>
                                <label>
                                    <input type="checkbox" id="filterMinor" value="minor" checked>
                                    Minor
                                </label>
                            </div>

                            <div class="key-selection-row">
                                <div class="key-selector" id="keySelector">
                                    <!-- Buttons generated by JavaScript -->
                                </div>
                                <div class="bulk-controls">
                                    <button class="control-button" id="selectAll">Select All</button>
                                    <button class="control-button" id="clearAll">Clear All</button>
                                </div>
                            </div>

                            <div class="highlight-section">
                                <span class="highlight-section-label">Display Mode:</span>
                                <button class="highlight-mode-button" id="highlightToggle">Highlight: Off</button>
                                <button class="highlight-mode-button" id="chordToneToggle">Chord Tones Only: Off</button>
                                <button class="highlight-mode-button circle-toggle-button" id="circleToggle">Circle of Fifths</button>
                            </div>
                        </div>

                        <!-- Scale Table Section -->
                        <div class="table-container">
                            <table id="scaleTable">
                                <thead>
                                    <tr>
                                        <th>SCALE ROOT</th>
                                        <th>1</th>
                                        <th>2</th>
                                        <th>3</th>
                                        <th>4</th>
                                        <th>5</th>
                                        <th>6</th>
                                        <th>7</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody">
                                    <tr>
                                        <td colspan="8" class="no-selection">
                                            Select keys above to view their scales
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

            <!-- Progressions Tab -->
            <div class="tab-panel" id="progressions-tab">
                <!-- Landing Progressions Section -->
                <div class="progressions-section">
                    <h3 class="section-header active">
                        <span>Landing Progressions (Resolutions)</span>
                        <span class="section-toggle">‚ñº</span>
                    </h3>
                    <div class="section-content active">
                        <!-- Description & Controls Section -->
                        <p>Common landing (resolution) chord progressions with their harmonic outline and character.</p>
                        <div class="table-filter-controls">
                            <label for="landingKeySelector"><strong>Select Key:</strong></label>
                            <select id="landingKeySelector" class="key-selector-dropdown">
                                <option value="">Show Formulas Only</option>
                                <option value="C">C</option>
                                <option value="Db">D‚ô≠</option>
                                <option value="D">D</option>
                                <option value="Eb">E‚ô≠</option>
                                <option value="E">E</option>
                                <option value="F">F</option>
                                <option value="Gb">G‚ô≠</option>
                                <option value="G">G</option>
                                <option value="Ab">A‚ô≠</option>
                                <option value="A">A</option>
                                <option value="Bb">B‚ô≠</option>
                                <option value="B">B</option>
                            </select>
                            <button class="filter-toggle-btn" id="landingFilterBtn" style="display: none;">Show Selected Only (0)</button>
                            <span class="filter-indicator" id="landingFilterIndicator" style="display: none;"></span>
                        </div>

                        <!-- Landing Progressions Table Section -->
                        <table id="landingProgressionsTable">
                            <thead>
                                <tr>
                                    <th style="width: 40px;"></th>
                                    <th>Progression</th>
                                    <th>Example Chords</th>
                                    <th>Voicing/Style</th>
                                    <th>Character / Usage</th>
                                </tr>
                            </thead>
                            <tbody id="landingProgressionsBody">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Key Transitions Section -->
                <div class="progressions-section">
                    <h3 class="section-header">
                        <span>Key Transitions (Where to Go)</span>
                        <span class="section-toggle">‚ñ∂</span>
                    </h3>
                    <div class="section-content">
                        <!-- Description & Controls Section -->
                        <p>Common transitions between keys with suggested chord progressions.</p>
                        <div class="table-filter-controls">
                            <button class="filter-toggle-btn" id="transitionsFilterBtn" style="display: none;">Show Selected Only (0)</button>
                            <span class="filter-indicator" id="transitionsFilterIndicator" style="display: none;"></span>
                        </div>

                        <!-- Key Transitions Table Section -->
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 40px;"></th>
                                    <th>From ‚Üí To</th>
                                    <th>Relationship</th>
                                    <th>Suggested Transition</th>
                                </tr>
                            </thead>
                            <tbody id="keyTransitionsBody">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chord Progressions Section -->
                <div class="progressions-section">
                    <h3 class="section-header">
                        <span>Chord Progressions</span>
                        <span class="section-toggle">‚ñ∂</span>
                    </h3>
                    <div class="section-content">
                        <!-- Description & Controls Section -->
                        <p>Curated chord progressions across styles and difficulties. Click any row to expand musicality notes.</p>

                        <!-- Understanding Notation Section -->
                        <div class="notation-guide">
                            <button class="notation-guide-toggle" id="notationGuideToggle">
                                <span>üìö Understanding Notation</span>
                                <span class="notation-guide-icon">‚ñº</span>
                            </button>
                            <div class="notation-guide-content" id="notationGuideContent">
                                <h4>Roman Numeral Basics</h4>
                                <p><strong>Uppercase = Major chords:</strong> I, IV, V (in C: C, F, G)</p>
                                <p><strong>Lowercase = Minor chords:</strong> ii, iii, vi (in C: Dm, Em, Am)</p>

                                <h4>Secondary/Applied Chords (V7/x)</h4>
                                <p><strong>V7/IV</strong> = "The dominant 7th <em>of</em> IV" ‚Üí Build V7 in the key of IV</p>
                                <p><strong>Example in C:</strong> V7/IV = C7 (V7 in key of F)</p>
                                <p><strong>V7/vi</strong> = E7 (V7 of Am), <strong>vii¬∞7/V</strong> = F#dim7 (vii¬∞7 of G)</p>
                                <p><em>Why it works:</em> Creates chromatic notes that pull strongly to target chord</p>

                                <h4>Figured Bass / Inversions</h4>
                                <p><strong>V6/4</strong> = Second inversion V (5th in bass) ‚Üí G/D in C</p>
                                <p><strong>I6</strong> = First inversion I (3rd in bass) ‚Üí C/E in C</p>
                                <p><strong>I/III</strong> = Slash chord notation (I with III in bass) ‚Üí C/E</p>
                                <p><em>Use:</em> Smooth bass movement, classical cadences</p>

                                <h4>Extensions & Qualities</h4>
                                <p><strong>7</strong> = dominant 7th (G7 = G-B-D-F)</p>
                                <p><strong>Maj7 or M7</strong> = major 7th (CMaj7 = C-E-G-B)</p>
                                <p><strong>m7</strong> = minor 7th (Dm7 = D-F-A-C)</p>
                                <p><strong>dim7 or ¬∞7</strong> = diminished 7th (Bdim7 = B-D-F-Ab)</p>
                                <p><strong>√∏7 or m7b5</strong> = half-diminished 7th (Bm7b5 = B-D-F-A)</p>
                                <p><strong>¬∞</strong> = diminished triad (Bdim = B-D-F)</p>
                                <p><strong>sus4</strong> = suspended 4th (Gsus4 = G-C-D, replaces 3rd)</p>
                                <p><strong>sus2</strong> = suspended 2nd (Gsus2 = G-A-D)</p>
                                <p><strong>add9</strong> = add 9th without 7th (Cadd9 = C-E-G-D)</p>
                                <p><strong>9, 11, 13</strong> = extended jazz voicings (includes 7th)</p>

                                <h4>Accidentals</h4>
                                <p><strong>bIII, bVI, bVII</strong> = Borrowed from parallel minor (C major: Eb, Ab, Bb)</p>
                                <p><strong>#IV</strong> = Raised 4th (in C: F#)</p>
                            </div>
                        </div>

                        <div class="table-filter-controls">
                            <label for="progressionStyleFilter"><strong>Style:</strong></label>
                            <select id="progressionStyleFilter" class="key-selector-dropdown">
                                <!-- Will be populated by JavaScript -->
                            </select>

                            <label for="progressionDifficultyFilter"><strong>Difficulty:</strong></label>
                            <select id="progressionDifficultyFilter" class="key-selector-dropdown">
                                <!-- Will be populated by JavaScript -->
                            </select>

                            <label for="progressionKeySelector"><strong>Key:</strong></label>
                            <select id="progressionKeySelector" class="key-selector-dropdown">
                                <option value="C">C</option>
                                <option value="Db">D‚ô≠</option>
                                <option value="D">D</option>
                                <option value="Eb">E‚ô≠</option>
                                <option value="E">E</option>
                                <option value="F">F</option>
                                <option value="Gb">G‚ô≠</option>
                                <option value="G">G</option>
                                <option value="Ab">A‚ô≠</option>
                                <option value="A">A</option>
                                <option value="Bb">B‚ô≠</option>
                                <option value="B">B</option>
                            </select>

                            <button class="filter-toggle-btn" id="progressionsFilterBtn" style="display: none;">Show Selected Only (0)</button>
                            <span class="filter-indicator" id="progressionsFilterIndicator" style="display: none;"></span>
                        </div>

                        <!-- Chord Progressions Table Section -->
                        <table id="chordProgressionsTable">
                            <thead>
                                <tr>
                                    <th style="width: 40px;"></th>
                                    <th>Formula</th>
                                    <th>Example (in C)</th>
                                    <th>Style</th>
                                    <th>Difficulty</th>
                                    <th>Character</th>
                                    <th style="width: 30px;"></th>
                                </tr>
                            </thead>
                            <tbody id="chordProgressionsBody">
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Genre Tab -->
            <div class="tab-panel" id="genre-tab">
                <div class="genre-description">
                    <p>Explore chord progressions organized by musical style and genre. Each category showcases the characteristic harmonic patterns that define the sound of that genre.</p>
                </div>

                <!-- Genre Sub-tab Navigation -->
                <div class="genre-tab-navigation">
                    <button class="genre-tab-button active" data-genre="Pop">Pop</button>
                    <button class="genre-tab-button" data-genre="Jazz">Jazz</button>
                    <button class="genre-tab-button" data-genre="Blues">Blues</button>
                    <button class="genre-tab-button" data-genre="Gospel">Gospel</button>
                    <button class="genre-tab-button" data-genre="Classical">Classical</button>
                    <button class="genre-tab-button" data-genre="Rock">Rock</button>
                    <button class="genre-tab-button" data-genre="Funk">Funk</button>
                    <button class="genre-tab-button" data-genre="Jazz Fusion">Jazz Fusion</button>
                    <button class="genre-tab-button" data-genre="Latin Jazz">Latin Jazz</button>
                    <button class="genre-tab-button" data-genre="Neo-Soul">Neo-Soul</button>
                    <button class="genre-tab-button" data-genre="Indie">Indie</button>
                    <button class="genre-tab-button" data-genre="Singer-Songwriter">Singer-Songwriter</button>
                    <button class="genre-tab-button" data-genre="R&B">R&B</button>
                    <button class="genre-tab-button" data-genre="Worship">Worship</button>
                    <button class="genre-tab-button" data-genre="Lo-Fi">Lo-Fi</button>
                    <button class="genre-tab-button" data-genre="Cinematic">Cinematic</button>
                </div>

                <!-- Genre Content Area -->
                <div class="genre-content-area">
                    <div class="genre-header">
                        <h3 id="genreTitle">Pop Progressions</h3>
                        <div class="genre-controls">
                            <div class="genre-instrument-toggle">
                                <label><strong>Instrument:</strong></label>
                                <button class="instrument-toggle-btn active" data-instrument="both">Both</button>
                                <button class="instrument-toggle-btn" data-instrument="keys">üéπ Keys</button>
                                <button class="instrument-toggle-btn" data-instrument="guitar">üé∏ Guitar</button>
                            </div>
                            <div class="genre-key-selector">
                                <label for="genreKeySelector"><strong>Key:</strong></label>
                                <select id="genreKeySelector" class="key-selector-dropdown">
                                    <option value="C">C</option>
                                    <option value="Db">D‚ô≠</option>
                                    <option value="D">D</option>
                                    <option value="Eb">E‚ô≠</option>
                                    <option value="E">E</option>
                                    <option value="F">F</option>
                                    <option value="Gb">G‚ô≠</option>
                                    <option value="G">G</option>
                                    <option value="Ab">A‚ô≠</option>
                                    <option value="A">A</option>
                                    <option value="Bb">B‚ô≠</option>
                                    <option value="B">B</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Progressions Section -->
                    <div class="genre-section">
                        <h3 class="genre-section-header active">
                            <span>üéµ Progressions</span>
                            <span class="section-toggle">‚ñº</span>
                        </h3>
                        <div class="genre-section-content active">
                            <table id="genreProgressionsTable">
                                <thead>
                                    <tr>
                                        <th>Formula</th>
                                        <th>Example Chords</th>
                                        <th>Difficulty</th>
                                        <th>Character</th>
                                        <th style="width: 30px;"></th>
                                    </tr>
                                </thead>
                                <tbody id="genreProgressionsBody">
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Scales & Theory Section -->
                    <div class="genre-section">
                        <h3 class="genre-section-header">
                            <span>üéπüé∏ Essential Theory & Scales</span>
                            <span class="section-toggle">‚ñ∂</span>
                        </h3>
                        <div class="genre-section-content" id="genreTheoryContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Rhythm & Feel Section -->
                    <div class="genre-section">
                        <h3 class="genre-section-header">
                            <span>ü•Å Rhythm & Feel</span>
                            <span class="section-toggle">‚ñ∂</span>
                        </h3>
                        <div class="genre-section-content" id="genreRhythmContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Licks & Tricks Section -->
                    <div class="genre-section">
                        <h3 class="genre-section-header">
                            <span>‚ú® Licks & Tricks</span>
                            <span class="section-toggle">‚ñ∂</span>
                        </h3>
                        <div class="genre-section-content" id="genreLicksContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Practice Resources Section -->
                    <div class="genre-section">
                        <h3 class="genre-section-header">
                            <span>üéß Practice Resources</span>
                            <span class="section-toggle">‚ñ∂</span>
                        </h3>
                        <div class="genre-section-content" id="genrePracticeContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chords & Theory Tab -->
            <div class="tab-panel" id="theory-tab">
                <div class="theory-section">
                    <h3>Chord Construction</h3>
                    <p>Reference content coming soon...</p>
                </div>
                <div class="theory-section">
                    <h3>Voice Leading</h3>
                    <p>Reference content coming soon...</p>
                </div>
                <div class="theory-section">
                    <h3>Rhythm & Groove Patterns</h3>
                    <p>Reference content coming soon...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Circle of Fifths Overlay -->
    <div class="circle-container" id="circleContainer">
        <div class="circle-of-fifths" id="circleOfFifths">
            <div class="circle-center">Circle<br>of<br>Fifths</div>
        </div>
    </div>

    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>

    <!-- Main application script -->
    <script type="module" src="./main.js"></script>
</body>
</html>
